# 需求对齐文档 - 内圈样式重构

## 原始需求
当前图片渲染设计未达预期，需要整体重构内圈样式。现有配色与结构过于单一，缺乏层次与节奏；系统提示词未被纳入设计，导致信息表达与空间利用严重不足，整体既不美观也无展示价值，属于空间浪费，需从视觉结构与信息组织两个层面同时重做。

## 项目上下文

### 技术栈
- 编程语言：TypeScript
- 框架版本：React
- UI库：Tailwind CSS
- 构建工具：Vite
- 其他依赖：react-markdown, prism-react-renderer, html2canvas

### 现有架构理解
- 架构模式：React函数组件 + Hooks
- 核心模块：
  - `PromptModal.tsx`: 包含预览卡片组件 `AestheticPreviewCard`
  - 预览卡片当前结构：
    1. 背景层（图片或渐变）
    2. macOS风格标题栏
    3. 内容区域（标题、描述、代码块）
    4. 装饰性渐变圆形元素（"内圈"）- **问题所在**
- 集成点：
  - 预览卡片接收 `data` 对象，包含 `title`, `content`, `description`, `category`, `previewMediaUrl` 等
  - 支持 `systemInstruction` 字段，但**未在预览卡片中展示**

### 当前问题分析

#### 1. 视觉结构问题
- **内圈装饰元素**（第865-888行）：
  - 仅有两个简单的径向渐变圆形（top-left 和 bottom-right）
  - 配色单一，仅根据主题变化颜色
  - 缺乏层次感和视觉节奏
  - 纯装饰性，无实际功能

#### 2. 信息组织问题
- **系统提示词缺失**：
  - `data.systemInstruction` 字段存在但未在预览卡片中展示
  - 预览卡片只展示了 `content`（主提示词）
  - 系统提示词是重要信息，应该被纳入设计

#### 3. 空间利用问题
- 装饰性元素占用空间但无信息价值
- 内容区域布局单一，缺乏信息层次
- 没有充分利用可用空间展示更多有用信息

## 需求理解

### 功能边界

**包含功能：**
- [x] 重构内圈装饰元素的视觉设计
  - 增加层次感和节奏感
  - 多层次的渐变和装饰效果
  - 与主题系统深度集成
- [x] 将系统提示词纳入预览卡片设计
  - 在视觉上区分系统提示词和主提示词
  - 合理利用空间展示系统提示词
- [x] 优化信息组织结构
  - 建立清晰的信息层次
  - 提高空间利用率
  - 增强视觉引导
- [x] 提升整体美观度
  - 现代化的视觉设计
  - 更好的配色方案
  - 增强的视觉节奏

**明确不包含（Out of Scope）：**
- [ ] 修改预览卡片的导出功能（html2canvas相关）
- [ ] 修改其他标签页（edit, examples, test, history）的布局
- [ ] 修改数据模型或类型定义
- [ ] 修改模态框的外部结构

## 疑问澄清

### P0级问题（必须澄清）

1. **内圈样式的具体定义**
   - 背景：用户提到"内圈样式"，从代码看是指装饰性渐变圆形元素
   - 影响：需要确认是否仅指这些装饰元素，还是包括整个内容区域的布局
   - 建议方案：基于代码分析，理解为装饰性元素 + 内容区域的信息组织重构

2. **系统提示词的展示方式**
   - 背景：系统提示词需要被纳入设计，但展示方式未明确
   - 影响：需要决定是单独区域展示，还是与主提示词整合展示
   - 建议方案：
     - 方案A：在代码块上方添加独立的系统提示词区域（推荐）
     - 方案B：在代码块内部以特殊样式展示系统提示词
     - 方案C：使用侧边栏或浮动面板展示

3. **视觉层次的具体要求**
   - 背景：需要"层次与节奏"，但具体程度未明确
   - 影响：设计复杂度需要平衡美观和性能
   - 建议方案：采用多层次渐变、阴影、边框组合，但保持性能优化

### P1级问题（建议确认）

4. **是否需要响应式调整**
   - 当前代码已有响应式设计（md:, lg: 断点）
   - 建议：保持现有响应式策略，确保新设计在不同屏幕尺寸下正常显示

5. **是否需要动画效果**
   - 当前已有 hover 效果和过渡动画
   - 建议：添加微妙的动画增强视觉节奏，但避免过度动画影响性能

## 验收标准

### 功能验收
- [ ] 内圈装饰元素具有多层次视觉效果，不再单一
- [ ] 系统提示词在预览卡片中可见且样式清晰
- [ ] 信息层次清晰，主提示词和系统提示词有明确区分
- [ ] 空间利用率提升，不再有"空间浪费"的感觉
- [ ] 整体美观度显著提升

### 质量验收
- [ ] 代码符合项目现有规范
- [ ] 保持与现有主题系统的兼容性
- [ ] 响应式设计正常工作
- [ ] 导出为图片功能正常工作（html2canvas）
- [ ] 性能无明显下降（渲染时间、内存占用）

### 视觉验收
- [ ] 配色方案丰富且有层次
- [ ] 视觉节奏感明显
- [ ] 信息组织清晰易读
- [ ] 与现有设计风格协调

## 技术约束

1. **保持现有API接口**：不修改 `AestheticPreviewCard` 组件的 props 接口
2. **主题系统兼容**：新设计必须支持所有现有主题（theme-default, theme-midnight, theme-aurora, theme-terminal, theme-light）
3. **性能要求**：避免过度复杂的CSS效果影响渲染性能
4. **可维护性**：代码结构清晰，便于后续维护和扩展

